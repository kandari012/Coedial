<link rel="stylesheet" href="/css/home.css" />
<h1>Codeial <%= title%></h1>

<% if(locals.user){%>
<section>
  <h4>Posts</h4>
  <form action="/posts/create" method="POST">
    <textarea name="content" cols="30" rows="3" required></textarea>
    <input type="submit" value="Post" />
  </form>
</section>
<%}%>

<div>
  <% for(let post of posts){%>
  <li>
    <p><%=post.content%></p>
    <p><%=post.user.name%></p>
    <div>
      <% if(locals.user){%>
      <form action="/comment/create" method="POST">
        <input
          type="text"
          name="content"
          placeholder="Type your comment here"
          required
        />
        <!-- hidden field -->
        <input type="hidden" name="post" value="<%=post._id%>" />
        <input type="submit" value="Add Comment" />
      </form>
      <%}%>

      <div>
        <ul id="post-comments-<%=post._id%>">
          <% for(let comment of post.comments){%>
          <p><%=comment.content%></p>
          <small><%=comment.user.name%></small>
          <%}%>
        </ul>
      </div>
    </div>
  </li>

  <%}%>
</div>
